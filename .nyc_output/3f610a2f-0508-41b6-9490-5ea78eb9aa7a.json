{"/Users/jim/git/oss/externa/src/ExternaRemoteProxy.js":{"path":"/Users/jim/git/oss/externa/src/ExternaRemoteProxy.js","statementMap":{"0":{"start":{"line":3,"column":0},"end":{"line":5,"column":3}},"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":34}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":59}},"3":{"start":{"line":9,"column":15},"end":{"line":9,"column":57}},"4":{"start":{"line":11,"column":15},"end":{"line":11,"column":35}},"5":{"start":{"line":13,"column":13},"end":{"line":13,"column":55}},"6":{"start":{"line":15,"column":15},"end":{"line":15,"column":34}},"7":{"start":{"line":17,"column":39},"end":{"line":17,"column":95}},"8":{"start":{"line":19,"column":20},"end":{"line":19,"column":22}},"9":{"start":{"line":20,"column":0},"end":{"line":20,"column":37}},"10":{"start":{"line":23,"column":2},"end":{"line":23,"column":50}},"11":{"start":{"line":26,"column":19},"end":{"line":68,"column":1}},"12":{"start":{"line":28,"column":4},"end":{"line":33,"column":6}},"13":{"start":{"line":36,"column":21},"end":{"line":36,"column":36}},"14":{"start":{"line":37,"column":20},"end":{"line":37,"column":34}},"15":{"start":{"line":38,"column":17},"end":{"line":38,"column":28}},"16":{"start":{"line":39,"column":4},"end":{"line":48,"column":6}},"17":{"start":{"line":51,"column":4},"end":{"line":59,"column":6}},"18":{"start":{"line":62,"column":4},"end":{"line":66,"column":6}},"19":{"start":{"line":70,"column":25},"end":{"line":183,"column":2}},"20":{"start":{"line":72,"column":4},"end":{"line":72,"column":25}},"21":{"start":{"line":73,"column":4},"end":{"line":73,"column":33}},"22":{"start":{"line":74,"column":4},"end":{"line":74,"column":35}},"23":{"start":{"line":76,"column":4},"end":{"line":78,"column":6}},"24":{"start":{"line":77,"column":6},"end":{"line":77,"column":58}},"25":{"start":{"line":86,"column":8},"end":{"line":86,"column":42}},"26":{"start":{"line":89,"column":8},"end":{"line":89,"column":45}},"27":{"start":{"line":90,"column":8},"end":{"line":90,"column":35}},"28":{"start":{"line":95,"column":22},"end":{"line":95,"column":41}},"29":{"start":{"line":96,"column":8},"end":{"line":96,"column":65}},"30":{"start":{"line":97,"column":8},"end":{"line":97,"column":27}},"31":{"start":{"line":101,"column":8},"end":{"line":101,"column":42}},"32":{"start":{"line":102,"column":8},"end":{"line":102,"column":38}},"33":{"start":{"line":103,"column":8},"end":{"line":103,"column":73}},"34":{"start":{"line":104,"column":8},"end":{"line":104,"column":37}},"35":{"start":{"line":107,"column":8},"end":{"line":107,"column":42}},"36":{"start":{"line":110,"column":8},"end":{"line":110,"column":45}},"37":{"start":{"line":111,"column":8},"end":{"line":111,"column":35}},"38":{"start":{"line":114,"column":8},"end":{"line":114,"column":47}},"39":{"start":{"line":117,"column":8},"end":{"line":117,"column":47}},"40":{"start":{"line":122,"column":22},"end":{"line":122,"column":45}},"41":{"start":{"line":123,"column":8},"end":{"line":123,"column":65}},"42":{"start":{"line":124,"column":8},"end":{"line":124,"column":27}},"43":{"start":{"line":125,"column":8},"end":{"line":125,"column":37}},"44":{"start":{"line":132,"column":8},"end":{"line":132,"column":108}},"45":{"start":{"line":133,"column":22},"end":{"line":133,"column":50}},"46":{"start":{"line":135,"column":8},"end":{"line":139,"column":9}},"47":{"start":{"line":136,"column":10},"end":{"line":136,"column":36}},"48":{"start":{"line":138,"column":10},"end":{"line":138,"column":80}},"49":{"start":{"line":142,"column":22},"end":{"line":142,"column":53}},"50":{"start":{"line":143,"column":8},"end":{"line":143,"column":69}},"51":{"start":{"line":144,"column":8},"end":{"line":144,"column":27}},"52":{"start":{"line":149,"column":22},"end":{"line":149,"column":47}},"53":{"start":{"line":150,"column":8},"end":{"line":150,"column":76}},"54":{"start":{"line":151,"column":8},"end":{"line":151,"column":27}},"55":{"start":{"line":156,"column":4},"end":{"line":156,"column":28}},"56":{"start":{"line":159,"column":4},"end":{"line":159,"column":37}},"57":{"start":{"line":162,"column":4},"end":{"line":162,"column":34}},"58":{"start":{"line":165,"column":4},"end":{"line":165,"column":37}},"59":{"start":{"line":168,"column":4},"end":{"line":168,"column":42}},"60":{"start":{"line":171,"column":19},"end":{"line":171,"column":33}},"61":{"start":{"line":172,"column":4},"end":{"line":172,"column":44}},"62":{"start":{"line":175,"column":4},"end":{"line":178,"column":7}},"63":{"start":{"line":181,"column":4},"end":{"line":181,"column":30}},"64":{"start":{"line":185,"column":0},"end":{"line":185,"column":48}}},"fnMap":{"0":{"name":"_interopRequireDefault","decl":{"start":{"line":17,"column":9},"end":{"line":17,"column":31}},"loc":{"start":{"line":17,"column":37},"end":{"line":17,"column":97}},"line":17},"1":{"name":"setHandlers","decl":{"start":{"line":22,"column":9},"end":{"line":22,"column":20}},"loc":{"start":{"line":22,"column":31},"end":{"line":24,"column":1}},"line":22},"2":{"name":"ping","decl":{"start":{"line":27,"column":17},"end":{"line":27,"column":21}},"loc":{"start":{"line":27,"column":24},"end":{"line":34,"column":3}},"line":27},"3":{"name":"pong","decl":{"start":{"line":35,"column":17},"end":{"line":35,"column":21}},"loc":{"start":{"line":35,"column":28},"end":{"line":49,"column":3}},"line":35},"4":{"name":"message","decl":{"start":{"line":50,"column":20},"end":{"line":50,"column":27}},"loc":{"start":{"line":50,"column":44},"end":{"line":60,"column":3}},"line":50},"5":{"name":"disconnect","decl":{"start":{"line":61,"column":23},"end":{"line":61,"column":33}},"loc":{"start":{"line":61,"column":36},"end":{"line":67,"column":3}},"line":61},"6":{"name":"initialize","decl":{"start":{"line":71,"column":23},"end":{"line":71,"column":33}},"loc":{"start":{"line":71,"column":63},"end":{"line":79,"column":3}},"line":71},"7":{"name":"(anonymous_7)","decl":{"start":{"line":76,"column":18},"end":{"line":76,"column":19}},"loc":{"start":{"line":76,"column":33},"end":{"line":78,"column":5}},"line":76},"8":{"name":"receivePing","decl":{"start":{"line":85,"column":28},"end":{"line":85,"column":39}},"loc":{"start":{"line":85,"column":46},"end":{"line":87,"column":7}},"line":85},"9":{"name":"sendPong","decl":{"start":{"line":88,"column":25},"end":{"line":88,"column":33}},"loc":{"start":{"line":88,"column":36},"end":{"line":91,"column":7}},"line":88},"10":{"name":"_onEnter","decl":{"start":{"line":94,"column":25},"end":{"line":94,"column":33}},"loc":{"start":{"line":94,"column":36},"end":{"line":98,"column":7}},"line":94},"11":{"name":"receivePong","decl":{"start":{"line":100,"column":28},"end":{"line":100,"column":39}},"loc":{"start":{"line":100,"column":46},"end":{"line":105,"column":7}},"line":100},"12":{"name":"receivePing","decl":{"start":{"line":106,"column":28},"end":{"line":106,"column":39}},"loc":{"start":{"line":106,"column":46},"end":{"line":108,"column":7}},"line":106},"13":{"name":"sendPong","decl":{"start":{"line":109,"column":25},"end":{"line":109,"column":33}},"loc":{"start":{"line":109,"column":36},"end":{"line":112,"column":7}},"line":109},"14":{"name":"receiveMessage","decl":{"start":{"line":113,"column":31},"end":{"line":113,"column":45}},"loc":{"start":{"line":113,"column":48},"end":{"line":115,"column":7}},"line":113},"15":{"name":"sendMessage","decl":{"start":{"line":116,"column":28},"end":{"line":116,"column":39}},"loc":{"start":{"line":116,"column":42},"end":{"line":118,"column":7}},"line":116},"16":{"name":"sendPong","decl":{"start":{"line":121,"column":25},"end":{"line":121,"column":33}},"loc":{"start":{"line":121,"column":40},"end":{"line":126,"column":7}},"line":121},"17":{"name":"receiveMessage","decl":{"start":{"line":131,"column":31},"end":{"line":131,"column":45}},"loc":{"start":{"line":131,"column":56},"end":{"line":140,"column":7}},"line":131},"18":{"name":"sendMessage","decl":{"start":{"line":141,"column":28},"end":{"line":141,"column":39}},"loc":{"start":{"line":141,"column":51},"end":{"line":145,"column":7}},"line":141},"19":{"name":"_onEnter","decl":{"start":{"line":148,"column":25},"end":{"line":148,"column":33}},"loc":{"start":{"line":148,"column":36},"end":{"line":152,"column":7}},"line":148},"20":{"name":"sendPing","decl":{"start":{"line":155,"column":21},"end":{"line":155,"column":29}},"loc":{"start":{"line":155,"column":32},"end":{"line":157,"column":3}},"line":155},"21":{"name":"receivePing","decl":{"start":{"line":158,"column":24},"end":{"line":158,"column":35}},"loc":{"start":{"line":158,"column":42},"end":{"line":160,"column":3}},"line":158},"22":{"name":"sendPong","decl":{"start":{"line":161,"column":21},"end":{"line":161,"column":29}},"loc":{"start":{"line":161,"column":36},"end":{"line":163,"column":3}},"line":161},"23":{"name":"receivePong","decl":{"start":{"line":164,"column":24},"end":{"line":164,"column":35}},"loc":{"start":{"line":164,"column":42},"end":{"line":166,"column":3}},"line":164},"24":{"name":"sendMessage","decl":{"start":{"line":167,"column":24},"end":{"line":167,"column":35}},"loc":{"start":{"line":167,"column":47},"end":{"line":169,"column":3}},"line":167},"25":{"name":"receiveMessage","decl":{"start":{"line":170,"column":27},"end":{"line":170,"column":41}},"loc":{"start":{"line":170,"column":49},"end":{"line":173,"column":3}},"line":170},"26":{"name":"send","decl":{"start":{"line":174,"column":17},"end":{"line":174,"column":21}},"loc":{"start":{"line":174,"column":31},"end":{"line":179,"column":3}},"line":174},"27":{"name":"disconnect","decl":{"start":{"line":180,"column":23},"end":{"line":180,"column":33}},"loc":{"start":{"line":180,"column":36},"end":{"line":182,"column":3}},"line":180}},"branchMap":{"0":{"loc":{"start":{"line":17,"column":46},"end":{"line":17,"column":94}},"type":"cond-expr","locations":[{"start":{"line":17,"column":70},"end":{"line":17,"column":73}},{"start":{"line":17,"column":76},"end":{"line":17,"column":94}}],"line":17},"1":{"loc":{"start":{"line":17,"column":46},"end":{"line":17,"column":67}},"type":"binary-expr","locations":[{"start":{"line":17,"column":46},"end":{"line":17,"column":49}},{"start":{"line":17,"column":53},"end":{"line":17,"column":67}}],"line":17},"2":{"loc":{"start":{"line":135,"column":8},"end":{"line":139,"column":9}},"type":"if","locations":[{"start":{"line":135,"column":8},"end":{"line":139,"column":9}},{"start":{"line":135,"column":8},"end":{"line":139,"column":9}}],"line":135}},"s":{"0":37,"1":37,"2":37,"3":37,"4":37,"5":37,"6":37,"7":74,"8":37,"9":37,"10":4,"11":37,"12":2,"13":3,"14":3,"15":3,"16":3,"17":2,"18":2,"19":37,"20":37,"21":37,"22":37,"23":37,"24":1,"25":1,"26":2,"27":2,"28":2,"29":2,"30":2,"31":3,"32":3,"33":3,"34":3,"35":1,"36":2,"37":2,"38":1,"39":1,"40":3,"41":3,"42":3,"43":3,"44":4,"45":4,"46":4,"47":2,"48":2,"49":2,"50":2,"51":2,"52":2,"53":2,"54":2,"55":1,"56":1,"57":1,"58":1,"59":1,"60":1,"61":1,"62":1,"63":1,"64":37},"f":{"0":74,"1":4,"2":2,"3":3,"4":2,"5":2,"6":37,"7":1,"8":1,"9":2,"10":2,"11":3,"12":1,"13":2,"14":1,"15":1,"16":3,"17":4,"18":2,"19":2,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":1},"b":{"0":[0,74],"1":[74,74],"2":[2,2]},"inputSourceMap":{"version":3,"sources":["ExternaRemoteProxy.js"],"names":["_userHandlers","setHandlers","handlers","packingSlips","ping","type","timeStamp","Date","ticket","instanceId","state","pong","pingData","message","envelope","disconnect","ExternaRemoteProxy","machina","Fsm","extend","initialize","options","target","handshakeComplete","logger","msg","initialState","states","uninitialized","sendPing","receivePing","sendPong","deferUntilTransition","transition","pinging","_onEnter","payload","JSON","stringify","send","receivePong","receiveMessage","sendMessage","ponging","connected","handler","disconnected","handle","postMessage","externa"],"mappings":"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","sourceRoot":"/Users/jim/git/oss/externa/src/","sourcesContent":["\nimport machina from \"machina\";\nimport { createUUID } from \"./helpers\";\nimport state from \"./state\";\nimport { logger as _logger } from \"./logger\";\n\nlet _userHandlers = {};\n\nexport function setHandlers( handlers ) {\n\t_userHandlers = handlers;\n}\n\nexport { _userHandlers as userHandlers };\n\nconst packingSlips = {\n\tping() {\n\t\treturn {\n\t\t\ttype: \"externa.ping\",\n\t\t\ttimeStamp: new Date(),\n\t\t\tticket: createUUID(),\n\t\t\tinstanceId: state.instanceId,\n\t\t};\n\t},\n\tpong( { instanceId, timeStamp, ticket, } ) {\n\t\treturn {\n\t\t\ttype: \"externa.pong\",\n\t\t\tinstanceId: state.instanceId,\n\t\t\ttimeStamp: new Date(),\n\t\t\tpingData: {\n\t\t\t\tinstanceId,\n\t\t\t\ttimeStamp,\n\t\t\t\tticket,\n\t\t\t},\n\t\t};\n\t},\n\tmessage( type, message ) {\n\t\treturn {\n\t\t\ttype: \"externa.message\",\n\t\t\tinstanceId: state.instanceId,\n\t\t\ttimeStamp: new Date(),\n\t\t\tenvelope: {\n\t\t\t\ttype,\n\t\t\t\tmessage,\n\t\t\t},\n\t\t};\n\t},\n\tdisconnect() {\n\t\treturn {\n\t\t\ttype: \"externa.disconnect\",\n\t\t\ttimeStamp: new Date(),\n\t\t\tinstanceId: state.instanceId,\n\t\t};\n\t},\n};\n\nconst ExternaRemoteProxy = machina.Fsm.extend( {\n\tinitialize( options, target, instanceId ) {\n\t\tthis.target = target;\n\t\tthis.instanceId = instanceId;\n\t\tthis.handshakeComplete = false;\n\t\tthis.logger = msg => {\n\t\t\t_logger( `[remote-proxy] ${ msg }` );\n\t\t};\n\t},\n\n\tinitialState: \"uninitialized\",\n\n\tstates: {\n\t\tuninitialized: {\n\t\t\tdisconnect: \"disconnected\",\n\t\t\tsendPing: \"pinging\",\n\t\t\treceivePing( ping ) {\n\t\t\t\tthis.instanceId = ping.instanceId;\n\t\t\t},\n\t\t\tsendPong() {\n\t\t\t\tthis.deferUntilTransition( \"ponging\" );\n\t\t\t\tthis.transition( \"ponging\" );\n\t\t\t},\n\t\t},\n\t\tpinging: {\n\t\t\t_onEnter() {\n\t\t\t\tconst payload = packingSlips.ping();\n\t\t\t\tthis.logger( `pinging: ${ JSON.stringify( payload ) }` );\n\t\t\t\tthis.send( payload );\n\t\t\t},\n\t\t\tdisconnect: \"disconnected\",\n\t\t\treceivePong( pong ) {\n\t\t\t\tthis.instanceId = pong.instanceId;\n\t\t\t\tthis.handshakeComplete = true;\n\t\t\t\tthis.logger( `completed handshake with ${ this.instanceId }` );\n\t\t\t\tthis.transition( \"connected\" );\n\t\t\t},\n\t\t\treceivePing( ping ) {\n\t\t\t\tthis.instanceId = ping.instanceId;\n\t\t\t},\n\t\t\tsendPong() {\n\t\t\t\tthis.deferUntilTransition( \"ponging\" );\n\t\t\t\tthis.transition( \"ponging\" );\n\t\t\t},\n\t\t\treceiveMessage() {\n\t\t\t\tthis.deferUntilTransition( \"connected\" );\n\t\t\t},\n\t\t\tsendMessage() {\n\t\t\t\tthis.deferUntilTransition( \"connected\" );\n\t\t\t},\n\t\t},\n\t\tponging: {\n\t\t\tsendPong( ping ) {\n\t\t\t\tconst payload = packingSlips.pong( ping );\n\t\t\t\tthis.logger( `ponging: ${ JSON.stringify( payload ) }` );\n\t\t\t\tthis.send( payload );\n\t\t\t\tthis.transition( \"connected\" );\n\t\t\t},\n\t\t},\n\t\tconnected: {\n\t\t\tping: \"pinging\",\n\t\t\tdisconnect: \"disconnected\",\n\t\t\treceiveMessage( envelope ) {\n\t\t\t\tthis.logger( `received message from ${ this.instanceId } ${ JSON.stringify( envelope ) }` );\n\t\t\t\tconst handler = _userHandlers[ envelope.type ];\n\t\t\t\tif ( handler ) {\n\t\t\t\t\thandler( envelope.message );\n\t\t\t\t} else {\n\t\t\t\t\tthis.logger( `no user handler for: ${ JSON.stringify( envelope ) }` );\n\t\t\t\t}\n\t\t\t},\n\t\t\tsendMessage( type, msg ) {\n\t\t\t\tconst payload = packingSlips.message( type, msg );\n\t\t\t\tthis.logger( `sending msg: ${ JSON.stringify( payload ) }` );\n\t\t\t\tthis.send( payload );\n\t\t\t},\n\t\t},\n\t\tdisconnected: {\n\t\t\t_onEnter() {\n\t\t\t\tconst payload = packingSlips.disconnect();\n\t\t\t\tthis.logger( `sending disconnect: ${ JSON.stringify( payload ) }` );\n\t\t\t\tthis.send( payload );\n\t\t\t},\n\t\t},\n\t},\n\n\tsendPing() {\n\t\tthis.handle( \"sendPing\" );\n\t},\n\n\treceivePing( ping ) {\n\t\tthis.handle( \"receivePing\", ping );\n\t},\n\n\tsendPong( ping ) {\n\t\tthis.handle( \"sendPong\", ping );\n\t},\n\n\treceivePong( pong ) {\n\t\tthis.handle( \"receivePong\", pong );\n\t},\n\n\tsendMessage( type, msg ) {\n\t\tthis.handle( \"sendMessage\", type, msg );\n\t},\n\n\treceiveMessage( { envelope, } ) {\n\t\tthis.handle( \"receiveMessage\", envelope );\n\t},\n\n\tsend( payload ) {\n\t\tthis.target.postMessage( {\n\t\t\texterna: true,\n\t\t\tpayload,\n\t\t} );\n\t},\n\n\tdisconnect() {\n\t\tthis.handle( \"disconnect\" );\n\t},\n} );\n\nexport { ExternaRemoteProxy };\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d686de363a5edd2c49998fbad151608195869f60","contentHash":"07a34778bc92789ae91ca82c274032520831ba6a07712c2ee30987197bdf6b51"},"/Users/jim/git/oss/externa/src/helpers.js":{"path":"/Users/jim/git/oss/externa/src/helpers.js","statementMap":{"0":{"start":{"line":3,"column":0},"end":{"line":5,"column":3}},"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":32}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":36}},"3":{"start":{"line":9,"column":13},"end":{"line":9,"column":55}},"4":{"start":{"line":11,"column":39},"end":{"line":11,"column":95}},"5":{"start":{"line":13,"column":35},"end":{"line":13,"column":151}},"6":{"start":{"line":15,"column":32},"end":{"line":15,"column":188}},"7":{"start":{"line":17,"column":50},"end":{"line":17,"column":65}},"8":{"start":{"line":17,"column":58},"end":{"line":17,"column":65}},"9":{"start":{"line":17,"column":66},"end":{"line":17,"column":129}},"10":{"start":{"line":17,"column":93},"end":{"line":17,"column":129}},"11":{"start":{"line":17,"column":138},"end":{"line":17,"column":184}},"12":{"start":{"line":17,"column":186},"end":{"line":17,"column":246}},"13":{"start":{"line":17,"column":223},"end":{"line":17,"column":246}},"14":{"start":{"line":17,"column":247},"end":{"line":17,"column":300}},"15":{"start":{"line":17,"column":279},"end":{"line":17,"column":300}},"16":{"start":{"line":17,"column":301},"end":{"line":17,"column":414}},"17":{"start":{"line":17,"column":378},"end":{"line":17,"column":414}},"18":{"start":{"line":19,"column":34},"end":{"line":19,"column":156}},"19":{"start":{"line":19,"column":132},"end":{"line":19,"column":156}},"20":{"start":{"line":21,"column":35},"end":{"line":21,"column":89}},"21":{"start":{"line":21,"column":59},"end":{"line":21,"column":89}},"22":{"start":{"line":23,"column":39},"end":{"line":23,"column":93}},"23":{"start":{"line":23,"column":76},"end":{"line":23,"column":93}},"24":{"start":{"line":23,"column":94},"end":{"line":23,"column":168}},"25":{"start":{"line":23,"column":107},"end":{"line":23,"column":108}},"26":{"start":{"line":23,"column":117},"end":{"line":23,"column":131}},"27":{"start":{"line":23,"column":149},"end":{"line":23,"column":166}},"28":{"start":{"line":23,"column":169},"end":{"line":23,"column":181}},"29":{"start":{"line":26,"column":10},"end":{"line":26,"column":12}},"30":{"start":{"line":27,"column":18},"end":{"line":27,"column":36}},"31":{"start":{"line":30,"column":2},"end":{"line":32,"column":3}},"32":{"start":{"line":30,"column":15},"end":{"line":30,"column":16}},"33":{"start":{"line":31,"column":4},"end":{"line":31,"column":65}},"34":{"start":{"line":34,"column":2},"end":{"line":34,"column":14}},"35":{"start":{"line":38,"column":2},"end":{"line":38,"column":49}},"36":{"start":{"line":42,"column":2},"end":{"line":42,"column":37}},"37":{"start":{"line":45,"column":2},"end":{"line":45,"column":20}},"38":{"start":{"line":49,"column":2},"end":{"line":51,"column":3}},"39":{"start":{"line":50,"column":4},"end":{"line":50,"column":18}},"40":{"start":{"line":53,"column":16},"end":{"line":55,"column":4}},"41":{"start":{"line":54,"column":4},"end":{"line":54,"column":27}},"42":{"start":{"line":57,"column":2},"end":{"line":59,"column":3}},"43":{"start":{"line":58,"column":4},"end":{"line":58,"column":32}},"44":{"start":{"line":62,"column":2},"end":{"line":62,"column":17}}},"fnMap":{"0":{"name":"_interopRequireDefault","decl":{"start":{"line":11,"column":9},"end":{"line":11,"column":31}},"loc":{"start":{"line":11,"column":37},"end":{"line":11,"column":97}},"line":11},"1":{"name":"_toConsumableArray","decl":{"start":{"line":13,"column":9},"end":{"line":13,"column":27}},"loc":{"start":{"line":13,"column":33},"end":{"line":13,"column":153}},"line":13},"2":{"name":"_nonIterableSpread","decl":{"start":{"line":15,"column":9},"end":{"line":15,"column":27}},"loc":{"start":{"line":15,"column":30},"end":{"line":15,"column":190}},"line":15},"3":{"name":"_unsupportedIterableToArray","decl":{"start":{"line":17,"column":9},"end":{"line":17,"column":36}},"loc":{"start":{"line":17,"column":48},"end":{"line":17,"column":416}},"line":17},"4":{"name":"_iterableToArray","decl":{"start":{"line":19,"column":9},"end":{"line":19,"column":25}},"loc":{"start":{"line":19,"column":32},"end":{"line":19,"column":158}},"line":19},"5":{"name":"_arrayWithoutHoles","decl":{"start":{"line":21,"column":9},"end":{"line":21,"column":27}},"loc":{"start":{"line":21,"column":33},"end":{"line":21,"column":91}},"line":21},"6":{"name":"_arrayLikeToArray","decl":{"start":{"line":23,"column":9},"end":{"line":23,"column":26}},"loc":{"start":{"line":23,"column":37},"end":{"line":23,"column":183}},"line":23},"7":{"name":"createUUID","decl":{"start":{"line":25,"column":9},"end":{"line":25,"column":19}},"loc":{"start":{"line":25,"column":22},"end":{"line":46,"column":1}},"line":25},"8":{"name":"getExternals","decl":{"start":{"line":48,"column":9},"end":{"line":48,"column":21}},"loc":{"start":{"line":48,"column":24},"end":{"line":63,"column":1}},"line":48},"9":{"name":"(anonymous_9)","decl":{"start":{"line":53,"column":80},"end":{"line":53,"column":81}},"loc":{"start":{"line":53,"column":93},"end":{"line":55,"column":3}},"line":53}},"branchMap":{"0":{"loc":{"start":{"line":11,"column":46},"end":{"line":11,"column":94}},"type":"cond-expr","locations":[{"start":{"line":11,"column":70},"end":{"line":11,"column":73}},{"start":{"line":11,"column":76},"end":{"line":11,"column":94}}],"line":11},"1":{"loc":{"start":{"line":11,"column":46},"end":{"line":11,"column":67}},"type":"binary-expr","locations":[{"start":{"line":11,"column":46},"end":{"line":11,"column":49}},{"start":{"line":11,"column":53},"end":{"line":11,"column":67}}],"line":11},"2":{"loc":{"start":{"line":13,"column":42},"end":{"line":13,"column":150}},"type":"binary-expr","locations":[{"start":{"line":13,"column":42},"end":{"line":13,"column":65}},{"start":{"line":13,"column":69},"end":{"line":13,"column":90}},{"start":{"line":13,"column":94},"end":{"line":13,"column":126}},{"start":{"line":13,"column":130},"end":{"line":13,"column":150}}],"line":13},"3":{"loc":{"start":{"line":17,"column":50},"end":{"line":17,"column":65}},"type":"if","locations":[{"start":{"line":17,"column":50},"end":{"line":17,"column":65}},{"start":{"line":17,"column":50},"end":{"line":17,"column":65}}],"line":17},"4":{"loc":{"start":{"line":17,"column":66},"end":{"line":17,"column":129}},"type":"if","locations":[{"start":{"line":17,"column":66},"end":{"line":17,"column":129}},{"start":{"line":17,"column":66},"end":{"line":17,"column":129}}],"line":17},"5":{"loc":{"start":{"line":17,"column":186},"end":{"line":17,"column":246}},"type":"if","locations":[{"start":{"line":17,"column":186},"end":{"line":17,"column":246}},{"start":{"line":17,"column":186},"end":{"line":17,"column":246}}],"line":17},"6":{"loc":{"start":{"line":17,"column":190},"end":{"line":17,"column":221}},"type":"binary-expr","locations":[{"start":{"line":17,"column":190},"end":{"line":17,"column":204}},{"start":{"line":17,"column":208},"end":{"line":17,"column":221}}],"line":17},"7":{"loc":{"start":{"line":17,"column":247},"end":{"line":17,"column":300}},"type":"if","locations":[{"start":{"line":17,"column":247},"end":{"line":17,"column":300}},{"start":{"line":17,"column":247},"end":{"line":17,"column":300}}],"line":17},"8":{"loc":{"start":{"line":17,"column":251},"end":{"line":17,"column":277}},"type":"binary-expr","locations":[{"start":{"line":17,"column":251},"end":{"line":17,"column":262}},{"start":{"line":17,"column":266},"end":{"line":17,"column":277}}],"line":17},"9":{"loc":{"start":{"line":17,"column":301},"end":{"line":17,"column":414}},"type":"if","locations":[{"start":{"line":17,"column":301},"end":{"line":17,"column":414}},{"start":{"line":17,"column":301},"end":{"line":17,"column":414}}],"line":17},"10":{"loc":{"start":{"line":17,"column":305},"end":{"line":17,"column":376}},"type":"binary-expr","locations":[{"start":{"line":17,"column":305},"end":{"line":17,"column":322}},{"start":{"line":17,"column":326},"end":{"line":17,"column":376}}],"line":17},"11":{"loc":{"start":{"line":19,"column":34},"end":{"line":19,"column":156}},"type":"if","locations":[{"start":{"line":19,"column":34},"end":{"line":19,"column":156}},{"start":{"line":19,"column":34},"end":{"line":19,"column":156}}],"line":19},"12":{"loc":{"start":{"line":19,"column":38},"end":{"line":19,"column":130}},"type":"binary-expr","locations":[{"start":{"line":19,"column":38},"end":{"line":19,"column":67}},{"start":{"line":19,"column":71},"end":{"line":19,"column":100}},{"start":{"line":19,"column":104},"end":{"line":19,"column":130}}],"line":19},"13":{"loc":{"start":{"line":21,"column":35},"end":{"line":21,"column":89}},"type":"if","locations":[{"start":{"line":21,"column":35},"end":{"line":21,"column":89}},{"start":{"line":21,"column":35},"end":{"line":21,"column":89}}],"line":21},"14":{"loc":{"start":{"line":23,"column":39},"end":{"line":23,"column":93}},"type":"if","locations":[{"start":{"line":23,"column":39},"end":{"line":23,"column":93}},{"start":{"line":23,"column":39},"end":{"line":23,"column":93}}],"line":23},"15":{"loc":{"start":{"line":23,"column":43},"end":{"line":23,"column":74}},"type":"binary-expr","locations":[{"start":{"line":23,"column":43},"end":{"line":23,"column":54}},{"start":{"line":23,"column":58},"end":{"line":23,"column":74}}],"line":23},"16":{"loc":{"start":{"line":49,"column":2},"end":{"line":51,"column":3}},"type":"if","locations":[{"start":{"line":49,"column":2},"end":{"line":51,"column":3}},{"start":{"line":49,"column":2},"end":{"line":51,"column":3}}],"line":49},"17":{"loc":{"start":{"line":57,"column":2},"end":{"line":59,"column":3}},"type":"if","locations":[{"start":{"line":57,"column":2},"end":{"line":59,"column":3}},{"start":{"line":57,"column":2},"end":{"line":59,"column":3}}],"line":57},"18":{"loc":{"start":{"line":57,"column":6},"end":{"line":57,"column":47}},"type":"binary-expr","locations":[{"start":{"line":57,"column":6},"end":{"line":57,"column":19}},{"start":{"line":57,"column":23},"end":{"line":57,"column":47}}],"line":57}},"s":{"0":12,"1":12,"2":12,"3":12,"4":12,"5":9,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":9,"21":9,"22":9,"23":9,"24":9,"25":9,"26":9,"27":27,"28":9,"29":10000,"30":10000,"31":10000,"32":10000,"33":360000,"34":10000,"35":10000,"36":10000,"37":10000,"38":11,"39":2,"40":9,"41":27,"42":9,"43":3,"44":9},"f":{"0":12,"1":9,"2":0,"3":0,"4":0,"5":9,"6":9,"7":10000,"8":11,"9":27},"b":{"0":[0,12],"1":[12,12],"2":[9,0,0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0,0],"13":[9,0],"14":[9,0],"15":[9,0],"16":[2,9],"17":[3,6],"18":[9,6]},"inputSourceMap":{"version":3,"sources":["helpers.js"],"names":["createUUID","s","hexDigits","i","substr","Math","floor","random","join","getExternals","state","isWorker","targets","document","getElementsByTagName","map","contentWindow","window","parent","push"],"mappings":";;;;;;;;AACA;;;;;;;;;;;;;;;;AAEO,SAASA,UAAT,GAAsB;AAC5B,MAAMC,CAAC,GAAG,EAAV;AACA,MAAMC,SAAS,GAAG,kBAAlB;AACA;;AACA,OAAM,IAAIC,CAAC,GAAG,CAAd,EAAiBA,CAAC,GAAG,EAArB,EAAyBA,CAAC,EAA1B,EAA+B;AAC9BF,IAAAA,CAAC,CAAEE,CAAF,CAAD,GAASD,SAAS,CAACE,MAAV,CAAkBC,IAAI,CAACC,KAAL,CAAYD,IAAI,CAACE,MAAL,KAAgB,IAA5B,CAAlB,EAAsD,CAAtD,CAAT;AACA;;AACDN,EAAAA,CAAC,CAAE,EAAF,CAAD,GAAU,GAAV,CAP4B,CAOb;;AACf;;AACAA,EAAAA,CAAC,CAAE,EAAF,CAAD,GAAUC,SAAS,CAACE,MAAV,CAAoBH,CAAC,CAAE,EAAF,CAAD,GAAU,GAAZ,GAAoB,GAAtC,EAA2C,CAA3C,CAAV,CAT4B,CAS8B;;AAC1D;;AACAA,EAAAA,CAAC,CAAE,CAAF,CAAD,GAASA,CAAC,CAAE,EAAF,CAAD,GAAUA,CAAC,CAAE,EAAF,CAAD,GAAUA,CAAC,CAAE,EAAF,CAAD,GAAU,GAAvC;AACA;;AACA,SAAOA,CAAC,CAACO,IAAF,CAAQ,EAAR,CAAP;AACA;;AAEM,SAASC,YAAT,GAAwB;AAC9B,MAAKC,kBAAMC,QAAX,EAAsB;AACrB,WAAO,CAAE,IAAF,CAAP,CADqB,CACH;AAClB;;AACD,MAAMC,OAAO,GAAG,mBAAKC,QAAQ,CAACC,oBAAT,CAA+B,QAA/B,CAAL,EAAkDC,GAAlD,CAAuD,UAAAZ,CAAC,EAAI;AAC3E,WAAOA,CAAC,CAACa,aAAT;AACA,GAFe,CAAhB;;AAGA,MAAKC,MAAM,CAACC,MAAP,IAAiBD,MAAM,CAACC,MAAP,KAAkBD,MAAxC,EAAiD;AAChDL,IAAAA,OAAO,CAACO,IAAR,CAAcF,MAAM,CAACC,MAArB;AACA,GAT6B,CAU9B;;;AACA,SAAON,OAAP;AACA","sourceRoot":"/Users/jim/git/oss/externa/src/","sourcesContent":["\nimport state from \"./state\";\n\nexport function createUUID() {\n\tconst s = [];\n\tconst hexDigits = \"0123456789abcdef\";\n\t/* eslint-disable no-magic-numbers */\n\tfor ( let i = 0; i < 36; i++ ) {\n\t\ts[ i ] = hexDigits.substr( Math.floor( Math.random() * 0x10 ), 1 );\n\t}\n\ts[ 14 ] = \"4\"; // bits 12-15 of the time_hi_and_version field to 0010\n\t/* jshint ignore:start */\n\ts[ 19 ] = hexDigits.substr( ( s[ 19 ] & 0x3 ) | 0x8, 1 ); // bits 6-7 of the clock_seq_hi_and_reserved to 01\n\t/* jshint ignore:end */\n\ts[ 8 ] = s[ 13 ] = s[ 18 ] = s[ 23 ] = \"-\";\n\t/* eslint-enable no-magic-numbers */\n\treturn s.join( \"\" );\n}\n\nexport function getExternals() {\n\tif ( state.isWorker ) {\n\t\treturn [ this, ]; // eslint-disable-line no-invalid-this\n\t}\n\tconst targets = [ ...document.getElementsByTagName( \"iframe\" ), ].map( i => {\n\t\treturn i.contentWindow;\n\t} );\n\tif ( window.parent && window.parent !== window ) {\n\t\ttargets.push( window.parent );\n\t}\n\t// TODO: determine if we need to include workers here?\n\treturn targets;\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8a377cdd10104e1f6797a11e384b1b8194eb8d71","contentHash":"424d7eea87d2180fc99f488c57323aa906f984d52cf96ffaa81e65ac67bc42a9"},"/Users/jim/git/oss/externa/src/inbound.js":{"path":"/Users/jim/git/oss/externa/src/inbound.js","statementMap":{"0":{"start":{"line":3,"column":0},"end":{"line":5,"column":3}},"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":50}},"2":{"start":{"line":8,"column":13},"end":{"line":8,"column":55}},"3":{"start":{"line":10,"column":26},"end":{"line":10,"column":57}},"4":{"start":{"line":12,"column":24},"end":{"line":12,"column":53}},"5":{"start":{"line":14,"column":14},"end":{"line":14,"column":33}},"6":{"start":{"line":16,"column":39},"end":{"line":16,"column":95}},"7":{"start":{"line":19,"column":2},"end":{"line":36,"column":3}},"8":{"start":{"line":20,"column":17},"end":{"line":20,"column":29}},"9":{"start":{"line":21,"column":18},"end":{"line":21,"column":36}},"10":{"start":{"line":23,"column":17},"end":{"line":23,"column":61}},"11":{"start":{"line":25,"column":4},"end":{"line":30,"column":5}},"12":{"start":{"line":26,"column":6},"end":{"line":26,"column":103}},"13":{"start":{"line":27,"column":6},"end":{"line":27,"column":90}},"14":{"start":{"line":29,"column":6},"end":{"line":29,"column":59}},"15":{"start":{"line":32,"column":4},"end":{"line":35,"column":7}}},"fnMap":{"0":{"name":"_interopRequireDefault","decl":{"start":{"line":16,"column":9},"end":{"line":16,"column":31}},"loc":{"start":{"line":16,"column":37},"end":{"line":16,"column":97}},"line":16},"1":{"name":"postMessageListener","decl":{"start":{"line":18,"column":9},"end":{"line":18,"column":28}},"loc":{"start":{"line":18,"column":36},"end":{"line":37,"column":1}},"line":18}},"branchMap":{"0":{"loc":{"start":{"line":16,"column":46},"end":{"line":16,"column":94}},"type":"cond-expr","locations":[{"start":{"line":16,"column":70},"end":{"line":16,"column":73}},{"start":{"line":16,"column":76},"end":{"line":16,"column":94}}],"line":16},"1":{"loc":{"start":{"line":16,"column":46},"end":{"line":16,"column":67}},"type":"binary-expr","locations":[{"start":{"line":16,"column":46},"end":{"line":16,"column":49}},{"start":{"line":16,"column":53},"end":{"line":16,"column":67}}],"line":16},"2":{"loc":{"start":{"line":19,"column":2},"end":{"line":36,"column":3}},"type":"if","locations":[{"start":{"line":19,"column":2},"end":{"line":36,"column":3}},{"start":{"line":19,"column":2},"end":{"line":36,"column":3}}],"line":19},"3":{"loc":{"start":{"line":25,"column":4},"end":{"line":30,"column":5}},"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":30,"column":5}},{"start":{"line":25,"column":4},"end":{"line":30,"column":5}}],"line":25}},"s":{"0":7,"1":7,"2":7,"3":7,"4":7,"5":7,"6":7,"7":7,"8":6,"9":6,"10":6,"11":6,"12":4,"13":4,"14":4,"15":6},"f":{"0":7,"1":7},"b":{"0":[0,7],"1":[7,7],"2":[6,1],"3":[4,2]},"inputSourceMap":{"version":3,"sources":["inbound.js"],"names":["postMessageListener","event","data","externa","source","payload","remote","state","knownExternals","get","instanceId","ExternaRemoteProxy","set","handleMessage","type"],"mappings":";;;;;;;AACA;;AACA;;AACA;;AACA;;;;AAEO,SAASA,mBAAT,CAA8BC,KAA9B,EAAsC;AAC5C,MAAKA,KAAK,CAACC,IAAN,CAAWC,OAAhB,EAA0B;AACzB,QAAMC,MAAM,GAAGH,KAAK,CAACG,MAArB;AACA,QAAMC,OAAO,GAAGJ,KAAK,CAACC,IAAN,CAAWG,OAA3B;;AACA,QAAIC,MAAM,GAAGC,kBAAMC,cAAN,CAAqBC,GAArB,CAA0BL,MAA1B,CAAb;;AACA,QAAK,CAACE,MAAN,EAAe;AACd,kFAA0DD,OAAO,CAACK,UAAlE;AACAJ,MAAAA,MAAM,GAAG,IAAIK,sCAAJ,CAAwB,EAAxB,EAA4BP,MAA5B,EAAoCC,OAAO,CAACK,UAA5C,CAAT;;AACAH,wBAAMC,cAAN,CAAqBI,GAArB,CAA0BR,MAA1B,EAAkCE,MAAlC;AACA;;AACD,iDAAsBO,aAAtB,CAAqCR,OAAO,CAACS,IAA7C,EAAmD;AAAEZ,MAAAA,IAAI,EAAEG,OAAR;AAAiBC,MAAAA,MAAM,EAANA;AAAjB,KAAnD;AACA;AACD","sourceRoot":"/Users/jim/git/oss/externa/src/","sourcesContent":["\nimport state from \"./state\";\nimport { ExternaRemoteProxy } from \"./ExternaRemoteProxy\";\nimport { getWindowAdapterFsm } from \"./windowAdapterFsm\";\nimport { logger } from \"./logger\";\n\nexport function postMessageListener( event ) {\n\tif ( event.data.externa ) {\n\t\tconst source = event.source;\n\t\tconst payload = event.data.payload;\n\t\tlet remote = state.knownExternals.get( source );\n\t\tif ( !remote ) {\n\t\t\tlogger( `received externa message from unknown source: ${ payload.instanceId }` );\n\t\t\tremote = new ExternaRemoteProxy( {}, source, payload.instanceId );\n\t\t\tstate.knownExternals.set( source, remote );\n\t\t}\n\t\tgetWindowAdapterFsm().handleMessage( payload.type, { data: payload, remote, } );\n\t}\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"9b0dceb936ae2b7ef2afa55b8f89f7e0ec776fdd","contentHash":"4507c419933b54e7198a90ea749906a788ef455b9f124bdd346f03be0d3f8ab6"},"/Users/jim/git/oss/externa/src/index.js":{"path":"/Users/jim/git/oss/externa/src/index.js","statementMap":{"0":{"start":{"line":3,"column":0},"end":{"line":5,"column":3}},"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":28}},"2":{"start":{"line":8,"column":15},"end":{"line":8,"column":35}},"3":{"start":{"line":10,"column":13},"end":{"line":10,"column":55}},"4":{"start":{"line":12,"column":15},"end":{"line":12,"column":35}},"5":{"start":{"line":14,"column":26},"end":{"line":14,"column":57}},"6":{"start":{"line":16,"column":24},"end":{"line":16,"column":53}},"7":{"start":{"line":18,"column":14},"end":{"line":18,"column":33}},"8":{"start":{"line":20,"column":39},"end":{"line":20,"column":95}},"9":{"start":{"line":22,"column":77},"end":{"line":22,"column":175}},"10":{"start":{"line":22,"column":94},"end":{"line":22,"column":107}},"11":{"start":{"line":22,"column":121},"end":{"line":22,"column":131}},"12":{"start":{"line":22,"column":151},"end":{"line":22,"column":165}},"13":{"start":{"line":22,"column":166},"end":{"line":22,"column":173}},"14":{"start":{"line":22,"column":176},"end":{"line":22,"column":263}},"15":{"start":{"line":22,"column":193},"end":{"line":22,"column":208}},"16":{"start":{"line":22,"column":218},"end":{"line":22,"column":261}},"17":{"start":{"line":24,"column":33},"end":{"line":24,"column":387}},"18":{"start":{"line":24,"column":65},"end":{"line":24,"column":69}},"19":{"start":{"line":24,"column":78},"end":{"line":24,"column":87}},"20":{"start":{"line":24,"column":89},"end":{"line":24,"column":384}},"21":{"start":{"line":24,"column":147},"end":{"line":24,"column":167}},"22":{"start":{"line":24,"column":193},"end":{"line":24,"column":264}},"23":{"start":{"line":24,"column":290},"end":{"line":24,"column":360}},"24":{"start":{"line":24,"column":363},"end":{"line":24,"column":380}},"25":{"start":{"line":26,"column":34},"end":{"line":26,"column":156}},"26":{"start":{"line":28,"column":30},"end":{"line":28,"column":191}},"27":{"start":{"line":30,"column":50},"end":{"line":30,"column":145}},"28":{"start":{"line":30,"column":147},"end":{"line":30,"column":170}},"29":{"start":{"line":30,"column":163},"end":{"line":30,"column":170}},"30":{"start":{"line":30,"column":182},"end":{"line":30,"column":184}},"31":{"start":{"line":30,"column":195},"end":{"line":30,"column":199}},"32":{"start":{"line":30,"column":210},"end":{"line":30,"column":215}},"33":{"start":{"line":30,"column":229},"end":{"line":30,"column":498}},"34":{"start":{"line":30,"column":235},"end":{"line":30,"column":360}},"35":{"start":{"line":30,"column":303},"end":{"line":30,"column":323}},"36":{"start":{"line":30,"column":324},"end":{"line":30,"column":358}},"37":{"start":{"line":30,"column":352},"end":{"line":30,"column":358}},"38":{"start":{"line":30,"column":377},"end":{"line":30,"column":387}},"39":{"start":{"line":30,"column":388},"end":{"line":30,"column":397}},"40":{"start":{"line":30,"column":410},"end":{"line":30,"column":496}},"41":{"start":{"line":30,"column":416},"end":{"line":30,"column":464}},"42":{"start":{"line":30,"column":449},"end":{"line":30,"column":464}},"43":{"start":{"line":30,"column":477},"end":{"line":30,"column":494}},"44":{"start":{"line":30,"column":485},"end":{"line":30,"column":494}},"45":{"start":{"line":30,"column":499},"end":{"line":30,"column":511}},"46":{"start":{"line":32,"column":32},"end":{"line":32,"column":67}},"47":{"start":{"line":32,"column":56},"end":{"line":32,"column":67}},"48":{"start":{"line":34,"column":66},"end":{"line":34,"column":136}},"49":{"start":{"line":34,"column":138},"end":{"line":34,"column":642}},"50":{"start":{"line":34,"column":149},"end":{"line":34,"column":482}},"51":{"start":{"line":34,"column":269},"end":{"line":34,"column":284}},"52":{"start":{"line":34,"column":277},"end":{"line":34,"column":284}},"53":{"start":{"line":34,"column":293},"end":{"line":34,"column":294}},"54":{"start":{"line":34,"column":304},"end":{"line":34,"column":319}},"55":{"start":{"line":34,"column":321},"end":{"line":34,"column":480}},"56":{"start":{"line":34,"column":354},"end":{"line":34,"column":395}},"57":{"start":{"line":34,"column":373},"end":{"line":34,"column":395}},"58":{"start":{"line":34,"column":396},"end":{"line":34,"column":434}},"59":{"start":{"line":34,"column":459},"end":{"line":34,"column":469}},"60":{"start":{"line":34,"column":483},"end":{"line":34,"column":640}},"61":{"start":{"line":34,"column":666},"end":{"line":34,"column":670}},"62":{"start":{"line":34,"column":681},"end":{"line":34,"column":686}},"63":{"start":{"line":34,"column":693},"end":{"line":34,"column":1004}},"64":{"start":{"line":34,"column":720},"end":{"line":34,"column":736}},"65":{"start":{"line":34,"column":769},"end":{"line":34,"column":778}},"66":{"start":{"line":34,"column":780},"end":{"line":34,"column":809}},"67":{"start":{"line":34,"column":810},"end":{"line":34,"column":822}},"68":{"start":{"line":34,"column":847},"end":{"line":34,"column":861}},"69":{"start":{"line":34,"column":862},"end":{"line":34,"column":872}},"70":{"start":{"line":34,"column":894},"end":{"line":34,"column":999}},"71":{"start":{"line":34,"column":900},"end":{"line":34,"column":962}},"72":{"start":{"line":34,"column":947},"end":{"line":34,"column":962}},"73":{"start":{"line":34,"column":975},"end":{"line":34,"column":997}},"74":{"start":{"line":34,"column":987},"end":{"line":34,"column":997}},"75":{"start":{"line":36,"column":50},"end":{"line":36,"column":65}},"76":{"start":{"line":36,"column":58},"end":{"line":36,"column":65}},"77":{"start":{"line":36,"column":66},"end":{"line":36,"column":129}},"78":{"start":{"line":36,"column":93},"end":{"line":36,"column":129}},"79":{"start":{"line":36,"column":138},"end":{"line":36,"column":184}},"80":{"start":{"line":36,"column":186},"end":{"line":36,"column":246}},"81":{"start":{"line":36,"column":223},"end":{"line":36,"column":246}},"82":{"start":{"line":36,"column":247},"end":{"line":36,"column":300}},"83":{"start":{"line":36,"column":279},"end":{"line":36,"column":300}},"84":{"start":{"line":36,"column":301},"end":{"line":36,"column":414}},"85":{"start":{"line":36,"column":378},"end":{"line":36,"column":414}},"86":{"start":{"line":38,"column":39},"end":{"line":38,"column":93}},"87":{"start":{"line":38,"column":76},"end":{"line":38,"column":93}},"88":{"start":{"line":38,"column":94},"end":{"line":38,"column":168}},"89":{"start":{"line":38,"column":107},"end":{"line":38,"column":108}},"90":{"start":{"line":38,"column":117},"end":{"line":38,"column":131}},"91":{"start":{"line":38,"column":149},"end":{"line":38,"column":166}},"92":{"start":{"line":38,"column":169},"end":{"line":38,"column":181}},"93":{"start":{"line":40,"column":0},"end":{"line":40,"column":65}},"94":{"start":{"line":41,"column":15},"end":{"line":137,"column":1}},"95":{"start":{"line":44,"column":4},"end":{"line":44,"column":86}},"96":{"start":{"line":45,"column":4},"end":{"line":45,"column":63}},"97":{"start":{"line":46,"column":4},"end":{"line":46,"column":40}},"98":{"start":{"line":48,"column":4},"end":{"line":53,"column":5}},"99":{"start":{"line":49,"column":6},"end":{"line":49,"column":61}},"100":{"start":{"line":52,"column":6},"end":{"line":52,"column":113}},"101":{"start":{"line":55,"column":4},"end":{"line":55,"column":56}},"102":{"start":{"line":58,"column":4},"end":{"line":58,"column":38}},"103":{"start":{"line":59,"column":4},"end":{"line":69,"column":7}},"104":{"start":{"line":60,"column":18},"end":{"line":60,"column":64}},"105":{"start":{"line":62,"column":6},"end":{"line":66,"column":7}},"106":{"start":{"line":63,"column":8},"end":{"line":63,"column":73}},"107":{"start":{"line":65,"column":8},"end":{"line":65,"column":62}},"108":{"start":{"line":68,"column":6},"end":{"line":68,"column":23}},"109":{"start":{"line":74,"column":4},"end":{"line":74,"column":41}},"110":{"start":{"line":75,"column":4},"end":{"line":75,"column":72}},"111":{"start":{"line":77,"column":20},"end":{"line":77,"column":80}},"112":{"start":{"line":80,"column":4},"end":{"line":92,"column":5}},"113":{"start":{"line":81,"column":6},"end":{"line":87,"column":7}},"114":{"start":{"line":82,"column":26},"end":{"line":82,"column":56}},"115":{"start":{"line":83,"column":18},"end":{"line":83,"column":32}},"116":{"start":{"line":84,"column":23},"end":{"line":84,"column":37}},"117":{"start":{"line":86,"column":8},"end":{"line":86,"column":30}},"118":{"start":{"line":89,"column":6},"end":{"line":89,"column":23}},"119":{"start":{"line":91,"column":6},"end":{"line":91,"column":20}},"120":{"start":{"line":94,"column":4},"end":{"line":94,"column":45}},"121":{"start":{"line":97,"column":4},"end":{"line":116,"column":10}},"122":{"start":{"line":98,"column":6},"end":{"line":115,"column":18}},"123":{"start":{"line":99,"column":8},"end":{"line":114,"column":9}},"124":{"start":{"line":100,"column":10},"end":{"line":113,"column":11}},"125":{"start":{"line":103,"column":14},"end":{"line":103,"column":67}},"126":{"start":{"line":104,"column":14},"end":{"line":104,"column":32}},"127":{"start":{"line":105,"column":14},"end":{"line":105,"column":36}},"128":{"start":{"line":108,"column":14},"end":{"line":108,"column":68}},"129":{"start":{"line":112,"column":14},"end":{"line":112,"column":37}},"130":{"start":{"line":120,"column":21},"end":{"line":120,"column":81}},"131":{"start":{"line":123,"column":4},"end":{"line":135,"column":5}},"132":{"start":{"line":124,"column":6},"end":{"line":130,"column":7}},"133":{"start":{"line":125,"column":27},"end":{"line":125,"column":58}},"134":{"start":{"line":126,"column":18},"end":{"line":126,"column":33}},"135":{"start":{"line":127,"column":23},"end":{"line":127,"column":38}},"136":{"start":{"line":129,"column":8},"end":{"line":129,"column":40}},"137":{"start":{"line":132,"column":6},"end":{"line":132,"column":24}},"138":{"start":{"line":134,"column":6},"end":{"line":134,"column":21}},"139":{"start":{"line":138,"column":0},"end":{"line":138,"column":30}},"140":{"start":{"line":139,"column":0},"end":{"line":139,"column":33}}},"fnMap":{"0":{"name":"_interopRequireDefault","decl":{"start":{"line":20,"column":9},"end":{"line":20,"column":31}},"loc":{"start":{"line":20,"column":37},"end":{"line":20,"column":97}},"line":20},"1":{"name":"asyncGeneratorStep","decl":{"start":{"line":22,"column":9},"end":{"line":22,"column":27}},"loc":{"start":{"line":22,"column":75},"end":{"line":22,"column":265}},"line":22},"2":{"name":"_asyncToGenerator","decl":{"start":{"line":24,"column":9},"end":{"line":24,"column":26}},"loc":{"start":{"line":24,"column":31},"end":{"line":24,"column":389}},"line":24},"3":{"name":"(anonymous_3)","decl":{"start":{"line":24,"column":40},"end":{"line":24,"column":41}},"loc":{"start":{"line":24,"column":52},"end":{"line":24,"column":386}},"line":24},"4":{"name":"(anonymous_4)","decl":{"start":{"line":24,"column":108},"end":{"line":24,"column":109}},"loc":{"start":{"line":24,"column":135},"end":{"line":24,"column":382}},"line":24},"5":{"name":"_next","decl":{"start":{"line":24,"column":178},"end":{"line":24,"column":183}},"loc":{"start":{"line":24,"column":191},"end":{"line":24,"column":266}},"line":24},"6":{"name":"_throw","decl":{"start":{"line":24,"column":276},"end":{"line":24,"column":282}},"loc":{"start":{"line":24,"column":288},"end":{"line":24,"column":362}},"line":24},"7":{"name":"_slicedToArray","decl":{"start":{"line":26,"column":9},"end":{"line":26,"column":23}},"loc":{"start":{"line":26,"column":32},"end":{"line":26,"column":158}},"line":26},"8":{"name":"_nonIterableRest","decl":{"start":{"line":28,"column":9},"end":{"line":28,"column":25}},"loc":{"start":{"line":28,"column":28},"end":{"line":28,"column":193}},"line":28},"9":{"name":"_iterableToArrayLimit","decl":{"start":{"line":30,"column":9},"end":{"line":30,"column":30}},"loc":{"start":{"line":30,"column":39},"end":{"line":30,"column":513}},"line":30},"10":{"name":"_arrayWithHoles","decl":{"start":{"line":32,"column":9},"end":{"line":32,"column":24}},"loc":{"start":{"line":32,"column":30},"end":{"line":32,"column":69}},"line":32},"11":{"name":"_createForOfIteratorHelper","decl":{"start":{"line":34,"column":9},"end":{"line":34,"column":35}},"loc":{"start":{"line":34,"column":55},"end":{"line":34,"column":1006}},"line":34},"12":{"name":"F","decl":{"start":{"line":34,"column":313},"end":{"line":34,"column":314}},"loc":{"start":{"line":34,"column":317},"end":{"line":34,"column":319}},"line":34},"13":{"name":"n","decl":{"start":{"line":34,"column":348},"end":{"line":34,"column":349}},"loc":{"start":{"line":34,"column":352},"end":{"line":34,"column":436}},"line":34},"14":{"name":"e","decl":{"start":{"line":34,"column":450},"end":{"line":34,"column":451}},"loc":{"start":{"line":34,"column":457},"end":{"line":34,"column":471}},"line":34},"15":{"name":"s","decl":{"start":{"line":34,"column":714},"end":{"line":34,"column":715}},"loc":{"start":{"line":34,"column":718},"end":{"line":34,"column":738}},"line":34},"16":{"name":"n","decl":{"start":{"line":34,"column":752},"end":{"line":34,"column":753}},"loc":{"start":{"line":34,"column":756},"end":{"line":34,"column":824}},"line":34},"17":{"name":"e","decl":{"start":{"line":34,"column":838},"end":{"line":34,"column":839}},"loc":{"start":{"line":34,"column":845},"end":{"line":34,"column":874}},"line":34},"18":{"name":"f","decl":{"start":{"line":34,"column":888},"end":{"line":34,"column":889}},"loc":{"start":{"line":34,"column":892},"end":{"line":34,"column":1001}},"line":34},"19":{"name":"_unsupportedIterableToArray","decl":{"start":{"line":36,"column":9},"end":{"line":36,"column":36}},"loc":{"start":{"line":36,"column":48},"end":{"line":36,"column":416}},"line":36},"20":{"name":"_arrayLikeToArray","decl":{"start":{"line":38,"column":9},"end":{"line":38,"column":26}},"loc":{"start":{"line":38,"column":37},"end":{"line":38,"column":183}},"line":38},"21":{"name":"init","decl":{"start":{"line":43,"column":17},"end":{"line":43,"column":21}},"loc":{"start":{"line":43,"column":31},"end":{"line":56,"column":3}},"line":43},"22":{"name":"connect","decl":{"start":{"line":57,"column":20},"end":{"line":57,"column":27}},"loc":{"start":{"line":57,"column":30},"end":{"line":70,"column":3}},"line":57},"23":{"name":"(anonymous_23)","decl":{"start":{"line":59,"column":41},"end":{"line":59,"column":42}},"loc":{"start":{"line":59,"column":61},"end":{"line":69,"column":5}},"line":59},"24":{"name":"connectWorker","decl":{"start":{"line":72,"column":26},"end":{"line":72,"column":39}},"loc":{"start":{"line":72,"column":42},"end":{"line":72,"column":44}},"line":72},"25":{"name":"disconnect","decl":{"start":{"line":73,"column":23},"end":{"line":73,"column":33}},"loc":{"start":{"line":73,"column":36},"end":{"line":95,"column":3}},"line":73},"26":{"name":"resumeUponCompletion","decl":{"start":{"line":96,"column":33},"end":{"line":96,"column":53}},"loc":{"start":{"line":96,"column":68},"end":{"line":117,"column":3}},"line":96},"27":{"name":"_callee","decl":{"start":{"line":97,"column":76},"end":{"line":97,"column":83}},"loc":{"start":{"line":97,"column":86},"end":{"line":116,"column":5}},"line":97},"28":{"name":"_callee$","decl":{"start":{"line":98,"column":46},"end":{"line":98,"column":54}},"loc":{"start":{"line":98,"column":65},"end":{"line":115,"column":7}},"line":98},"29":{"name":"sendMessage","decl":{"start":{"line":118,"column":24},"end":{"line":118,"column":35}},"loc":{"start":{"line":118,"column":47},"end":{"line":136,"column":3}},"line":118}},"branchMap":{"0":{"loc":{"start":{"line":20,"column":46},"end":{"line":20,"column":94}},"type":"cond-expr","locations":[{"start":{"line":20,"column":70},"end":{"line":20,"column":73}},{"start":{"line":20,"column":76},"end":{"line":20,"column":94}}],"line":20},"1":{"loc":{"start":{"line":20,"column":46},"end":{"line":20,"column":67}},"type":"binary-expr","locations":[{"start":{"line":20,"column":46},"end":{"line":20,"column":49}},{"start":{"line":20,"column":53},"end":{"line":20,"column":67}}],"line":20},"2":{"loc":{"start":{"line":22,"column":176},"end":{"line":22,"column":263}},"type":"if","locations":[{"start":{"line":22,"column":176},"end":{"line":22,"column":263}},{"start":{"line":22,"column":176},"end":{"line":22,"column":263}}],"line":22},"3":{"loc":{"start":{"line":26,"column":41},"end":{"line":26,"column":155}},"type":"binary-expr","locations":[{"start":{"line":26,"column":41},"end":{"line":26,"column":61}},{"start":{"line":26,"column":65},"end":{"line":26,"column":94}},{"start":{"line":26,"column":98},"end":{"line":26,"column":133}},{"start":{"line":26,"column":137},"end":{"line":26,"column":155}}],"line":26},"4":{"loc":{"start":{"line":30,"column":50},"end":{"line":30,"column":145}},"type":"cond-expr","locations":[{"start":{"line":30,"column":64},"end":{"line":30,"column":68}},{"start":{"line":30,"column":71},"end":{"line":30,"column":145}}],"line":30},"5":{"loc":{"start":{"line":30,"column":71},"end":{"line":30,"column":145}},"type":"binary-expr","locations":[{"start":{"line":30,"column":71},"end":{"line":30,"column":100}},{"start":{"line":30,"column":104},"end":{"line":30,"column":124}},{"start":{"line":30,"column":128},"end":{"line":30,"column":145}}],"line":30},"6":{"loc":{"start":{"line":30,"column":147},"end":{"line":30,"column":170}},"type":"if","locations":[{"start":{"line":30,"column":147},"end":{"line":30,"column":170}},{"start":{"line":30,"column":147},"end":{"line":30,"column":170}}],"line":30},"7":{"loc":{"start":{"line":30,"column":324},"end":{"line":30,"column":358}},"type":"if","locations":[{"start":{"line":30,"column":324},"end":{"line":30,"column":358}},{"start":{"line":30,"column":324},"end":{"line":30,"column":358}}],"line":30},"8":{"loc":{"start":{"line":30,"column":328},"end":{"line":30,"column":350}},"type":"binary-expr","locations":[{"start":{"line":30,"column":328},"end":{"line":30,"column":329}},{"start":{"line":30,"column":333},"end":{"line":30,"column":350}}],"line":30},"9":{"loc":{"start":{"line":30,"column":416},"end":{"line":30,"column":464}},"type":"if","locations":[{"start":{"line":30,"column":416},"end":{"line":30,"column":464}},{"start":{"line":30,"column":416},"end":{"line":30,"column":464}}],"line":30},"10":{"loc":{"start":{"line":30,"column":420},"end":{"line":30,"column":447}},"type":"binary-expr","locations":[{"start":{"line":30,"column":420},"end":{"line":30,"column":423}},{"start":{"line":30,"column":427},"end":{"line":30,"column":447}}],"line":30},"11":{"loc":{"start":{"line":30,"column":477},"end":{"line":30,"column":494}},"type":"if","locations":[{"start":{"line":30,"column":477},"end":{"line":30,"column":494}},{"start":{"line":30,"column":477},"end":{"line":30,"column":494}}],"line":30},"12":{"loc":{"start":{"line":32,"column":32},"end":{"line":32,"column":67}},"type":"if","locations":[{"start":{"line":32,"column":32},"end":{"line":32,"column":67}},{"start":{"line":32,"column":32},"end":{"line":32,"column":67}}],"line":32},"13":{"loc":{"start":{"line":34,"column":66},"end":{"line":34,"column":136}},"type":"binary-expr","locations":[{"start":{"line":34,"column":66},"end":{"line":34,"column":95}},{"start":{"line":34,"column":99},"end":{"line":34,"column":117}},{"start":{"line":34,"column":121},"end":{"line":34,"column":136}}],"line":34},"14":{"loc":{"start":{"line":34,"column":138},"end":{"line":34,"column":642}},"type":"if","locations":[{"start":{"line":34,"column":138},"end":{"line":34,"column":642}},{"start":{"line":34,"column":138},"end":{"line":34,"column":642}}],"line":34},"15":{"loc":{"start":{"line":34,"column":149},"end":{"line":34,"column":482}},"type":"if","locations":[{"start":{"line":34,"column":149},"end":{"line":34,"column":482}},{"start":{"line":34,"column":149},"end":{"line":34,"column":482}}],"line":34},"16":{"loc":{"start":{"line":34,"column":153},"end":{"line":34,"column":265}},"type":"binary-expr","locations":[{"start":{"line":34,"column":153},"end":{"line":34,"column":169}},{"start":{"line":34,"column":174},"end":{"line":34,"column":209}},{"start":{"line":34,"column":214},"end":{"line":34,"column":228}},{"start":{"line":34,"column":232},"end":{"line":34,"column":233}},{"start":{"line":34,"column":237},"end":{"line":34,"column":265}}],"line":34},"17":{"loc":{"start":{"line":34,"column":269},"end":{"line":34,"column":284}},"type":"if","locations":[{"start":{"line":34,"column":269},"end":{"line":34,"column":284}},{"start":{"line":34,"column":269},"end":{"line":34,"column":284}}],"line":34},"18":{"loc":{"start":{"line":34,"column":354},"end":{"line":34,"column":395}},"type":"if","locations":[{"start":{"line":34,"column":354},"end":{"line":34,"column":395}},{"start":{"line":34,"column":354},"end":{"line":34,"column":395}}],"line":34},"19":{"loc":{"start":{"line":34,"column":900},"end":{"line":34,"column":962}},"type":"if","locations":[{"start":{"line":34,"column":900},"end":{"line":34,"column":962}},{"start":{"line":34,"column":900},"end":{"line":34,"column":962}}],"line":34},"20":{"loc":{"start":{"line":34,"column":904},"end":{"line":34,"column":945}},"type":"binary-expr","locations":[{"start":{"line":34,"column":904},"end":{"line":34,"column":921}},{"start":{"line":34,"column":925},"end":{"line":34,"column":945}}],"line":34},"21":{"loc":{"start":{"line":34,"column":975},"end":{"line":34,"column":997}},"type":"if","locations":[{"start":{"line":34,"column":975},"end":{"line":34,"column":997}},{"start":{"line":34,"column":975},"end":{"line":34,"column":997}}],"line":34},"22":{"loc":{"start":{"line":36,"column":50},"end":{"line":36,"column":65}},"type":"if","locations":[{"start":{"line":36,"column":50},"end":{"line":36,"column":65}},{"start":{"line":36,"column":50},"end":{"line":36,"column":65}}],"line":36},"23":{"loc":{"start":{"line":36,"column":66},"end":{"line":36,"column":129}},"type":"if","locations":[{"start":{"line":36,"column":66},"end":{"line":36,"column":129}},{"start":{"line":36,"column":66},"end":{"line":36,"column":129}}],"line":36},"24":{"loc":{"start":{"line":36,"column":186},"end":{"line":36,"column":246}},"type":"if","locations":[{"start":{"line":36,"column":186},"end":{"line":36,"column":246}},{"start":{"line":36,"column":186},"end":{"line":36,"column":246}}],"line":36},"25":{"loc":{"start":{"line":36,"column":190},"end":{"line":36,"column":221}},"type":"binary-expr","locations":[{"start":{"line":36,"column":190},"end":{"line":36,"column":204}},{"start":{"line":36,"column":208},"end":{"line":36,"column":221}}],"line":36},"26":{"loc":{"start":{"line":36,"column":247},"end":{"line":36,"column":300}},"type":"if","locations":[{"start":{"line":36,"column":247},"end":{"line":36,"column":300}},{"start":{"line":36,"column":247},"end":{"line":36,"column":300}}],"line":36},"27":{"loc":{"start":{"line":36,"column":251},"end":{"line":36,"column":277}},"type":"binary-expr","locations":[{"start":{"line":36,"column":251},"end":{"line":36,"column":262}},{"start":{"line":36,"column":266},"end":{"line":36,"column":277}}],"line":36},"28":{"loc":{"start":{"line":36,"column":301},"end":{"line":36,"column":414}},"type":"if","locations":[{"start":{"line":36,"column":301},"end":{"line":36,"column":414}},{"start":{"line":36,"column":301},"end":{"line":36,"column":414}}],"line":36},"29":{"loc":{"start":{"line":36,"column":305},"end":{"line":36,"column":376}},"type":"binary-expr","locations":[{"start":{"line":36,"column":305},"end":{"line":36,"column":322}},{"start":{"line":36,"column":326},"end":{"line":36,"column":376}}],"line":36},"30":{"loc":{"start":{"line":38,"column":39},"end":{"line":38,"column":93}},"type":"if","locations":[{"start":{"line":38,"column":39},"end":{"line":38,"column":93}},{"start":{"line":38,"column":39},"end":{"line":38,"column":93}}],"line":38},"31":{"loc":{"start":{"line":38,"column":43},"end":{"line":38,"column":74}},"type":"binary-expr","locations":[{"start":{"line":38,"column":43},"end":{"line":38,"column":54}},{"start":{"line":38,"column":58},"end":{"line":38,"column":74}}],"line":38},"32":{"loc":{"start":{"line":44,"column":35},"end":{"line":44,"column":85}},"type":"binary-expr","locations":[{"start":{"line":44,"column":35},"end":{"line":44,"column":53}},{"start":{"line":44,"column":57},"end":{"line":44,"column":85}}],"line":44},"33":{"loc":{"start":{"line":48,"column":4},"end":{"line":53,"column":5}},"type":"if","locations":[{"start":{"line":48,"column":4},"end":{"line":53,"column":5}},{"start":{"line":48,"column":4},"end":{"line":53,"column":5}}],"line":48},"34":{"loc":{"start":{"line":62,"column":6},"end":{"line":66,"column":7}},"type":"if","locations":[{"start":{"line":62,"column":6},"end":{"line":66,"column":7}},{"start":{"line":62,"column":6},"end":{"line":66,"column":7}}],"line":62},"35":{"loc":{"start":{"line":100,"column":10},"end":{"line":113,"column":11}},"type":"switch","locations":[{"start":{"line":101,"column":12},"end":{"line":105,"column":36}},{"start":{"line":107,"column":12},"end":{"line":108,"column":68}},{"start":{"line":110,"column":12},"end":{"line":110,"column":19}},{"start":{"line":111,"column":12},"end":{"line":112,"column":37}}],"line":100}},"s":{"0":18,"1":18,"2":18,"3":18,"4":18,"5":18,"6":18,"7":18,"8":18,"9":6,"10":6,"11":6,"12":0,"13":0,"14":6,"15":3,"16":3,"17":3,"18":3,"19":3,"20":3,"21":3,"22":6,"23":0,"24":3,"25":5,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":5,"47":5,"48":5,"49":5,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":5,"62":5,"63":5,"64":5,"65":10,"66":10,"67":10,"68":0,"69":0,"70":5,"71":5,"72":0,"73":5,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":18,"94":18,"95":6,"96":6,"97":6,"98":6,"99":3,"100":3,"101":6,"102":3,"103":3,"104":6,"105":6,"106":3,"107":3,"108":6,"109":4,"110":4,"111":4,"112":4,"113":4,"114":4,"115":4,"116":4,"117":4,"118":0,"119":4,"120":4,"121":3,"122":3,"123":6,"124":6,"125":3,"126":3,"127":3,"128":3,"129":3,"130":1,"131":1,"132":1,"133":1,"134":1,"135":1,"136":1,"137":0,"138":1,"139":18,"140":18},"f":{"0":18,"1":6,"2":3,"3":3,"4":3,"5":6,"6":0,"7":5,"8":0,"9":0,"10":5,"11":5,"12":0,"13":0,"14":0,"15":5,"16":10,"17":0,"18":5,"19":0,"20":0,"21":6,"22":3,"23":6,"24":0,"25":4,"26":3,"27":3,"28":6,"29":1},"b":{"0":[0,18],"1":[18,18],"2":[3,3],"3":[5,0,0,0],"4":[0,0],"5":[0,0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[5,0],"13":[5,5,0],"14":[0,5],"15":[0,0],"16":[0,0,0,0,0],"17":[0,0],"18":[0,0],"19":[0,5],"20":[5,0],"21":[0,5],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[6,3],"33":[3,3],"34":[3,3],"35":[3,3,3,3]},"inputSourceMap":{"version":3,"sources":["index.js"],"names":["window","addEventListener","postMessageListener","knownExternals","state","init","options","instanceId","handlers","console","warn","connect","forEach","external","proxy","get","ExternaRemoteProxy","set","sendPing","connectWorker","disconnect","removeEventListener","key","clear","resumeUponCompletion","workToBeDone","pause","resume","sendMessage","type","msg"],"mappings":";;;;;;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;;;;;;;;;;;;;;;;;;;AAEAA,MAAM,CAACC,gBAAP,CAAyB,SAAzB,EAAoCC,4BAApC;eAEe;AACdC,EAAAA,cAAc,EAAEC,kBAAMD,cADR;AAGdE,EAAAA,IAHc,gBAGRC,OAHQ,EAGE;AACfF,sBAAMG,UAAN,GAAmBD,OAAO,CAACC,UAAR,IAAsBH,kBAAMG,UAA/C;AACA,iCAAiBH,kBAAMG,UAAvB;AACA,wBAAQ,cAAR;;AACA,QAAKD,OAAO,CAACE,QAAb,EAAwB;AACvB,2CAAaF,OAAO,CAACE,QAArB;AACA,KAFD,MAEO;AACN;AACAC,MAAAA,OAAO,CAACC,IAAR,CAAc,4FAAd;AACA;;AACD,iDAAsBL,IAAtB;AACA,GAda;AAgBdM,EAAAA,OAhBc,qBAgBJ;AACT,wBAAQ,YAAR;AACA,iCAAeC,OAAf,CAAwB,UAAAC,QAAQ,EAAI;AACnC,UAAIC,KAAK,GAAGV,kBAAMD,cAAN,CAAqBY,GAArB,CAA0BF,QAA1B,CAAZ;;AACA,UAAK,CAACC,KAAN,EAAc;AACbA,QAAAA,KAAK,GAAG,IAAIE,sCAAJ,CAAwB,EAAxB,EAA4BH,QAA5B,CAAR;;AACAT,0BAAMD,cAAN,CAAqBc,GAArB,CAA0BJ,QAA1B,EAAoCC,KAApC;AACA;;AACDA,MAAAA,KAAK,CAACI,QAAN;AACA,KAPD;AAQA,GA1Ba;AA4Bd;AACAC,EAAAA,aA7Bc,2BA6BE,CAAE,CA7BJ;AA+BdC,EAAAA,UA/Bc,wBA+BD;AACZ,wBAAQ,eAAR;AACApB,IAAAA,MAAM,CAACqB,mBAAP,CAA4B,SAA5B,EAAuCnB,4BAAvC,EAFY,CAGZ;;AAHY,+CAIsBE,kBAAMD,cAJ5B;AAAA;;AAAA;AAIZ,0DAAyD;AAAA;AAAA,YAA3CmB,GAA2C;AAAA,YAAtCT,QAAsC;;AACxDA,QAAAA,QAAQ,CAACO,UAAT;AACA;AANW;AAAA;AAAA;AAAA;AAAA;;AAOZhB,sBAAMD,cAAN,CAAqBoB,KAArB;AACA,GAvCa;AAyCRC,EAAAA,oBAzCQ,gCAyCcC,YAzCd,EAyC6B;AAAA;AAAA;AAAA;AAAA;AAAA;AAC1C;AACA,2DAAsBC,KAAtB;AAF0C;AAAA,qBAGpCD,YAAY,EAHwB;;AAAA;AAI1C,2DAAsBE,MAAtB;;AAJ0C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAK1C,GA9Ca;AAgDdC,EAAAA,WAhDc,uBAgDDC,IAhDC,EAgDKC,GAhDL,EAgDW;AACxB;AADwB,gDAEU1B,kBAAMD,cAFhB;AAAA;;AAAA;AAExB,6DAAyD;AAAA;AAAA,YAA3CmB,GAA2C;AAAA,YAAtCT,QAAsC;;AACxDA,QAAAA,QAAQ,CAACe,WAAT,CAAsBC,IAAtB,EAA4BC,GAA5B;AACA;AAJuB;AAAA;AAAA;AAAA;AAAA;AAKxB;AArDa,C","sourceRoot":"/Users/jim/git/oss/externa/src/","sourcesContent":["\nimport { postMessageListener } from \"./inbound\";\nimport state from \"./state\";\nimport { getExternals } from \"./helpers\";\nimport { ExternaRemoteProxy, setHandlers } from \"./ExternaRemoteProxy\";\nimport { getWindowAdapterFsm } from \"./windowAdapterFsm\";\nimport { setLogNamespace, logger } from \"./logger\";\n\nwindow.addEventListener( \"message\", postMessageListener );\n\nexport default {\n\tknownExternals: state.knownExternals,\n\n\tinit( options ) {\n\t\tstate.instanceId = options.instanceId || state.instanceId;\n\t\tsetLogNamespace( state.instanceId );\n\t\tlogger( \"initializing\" );\n\t\tif ( options.handlers ) {\n\t\t\tsetHandlers( options.handlers );\n\t\t} else {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn( \"externa has not been configured with user handlers, so no inbound messages will be handled\" );\n\t\t}\n\t\tgetWindowAdapterFsm().init();\n\t},\n\n\tconnect() {\n\t\tlogger( \"connecting\" );\n\t\tgetExternals().forEach( external => {\n\t\t\tlet proxy = state.knownExternals.get( external );\n\t\t\tif ( !proxy ) {\n\t\t\t\tproxy = new ExternaRemoteProxy( {}, external );\n\t\t\t\tstate.knownExternals.set( external, proxy );\n\t\t\t}\n\t\t\tproxy.sendPing();\n\t\t} );\n\t},\n\n\t// Intentionally not yet implemented\n\tconnectWorker() {},\n\n\tdisconnect() {\n\t\tlogger( \"disconnecting\" );\n\t\twindow.removeEventListener( \"message\", postMessageListener );\n\t\t// eslint-disable-next-line no-unused-vars\n\t\tfor ( const [ key, external, ] of state.knownExternals ) {\n\t\t\texternal.disconnect();\n\t\t}\n\t\tstate.knownExternals.clear();\n\t},\n\n\tasync resumeUponCompletion( workToBeDone ) {\n\t\t// TODO: throw here if FSM is not in ready state\n\t\tgetWindowAdapterFsm().pause();\n\t\tawait workToBeDone();\n\t\tgetWindowAdapterFsm().resume();\n\t},\n\n\tsendMessage( type, msg ) {\n\t\t// eslint-disable-next-line no-unused-vars\n\t\tfor ( const [ key, external, ] of state.knownExternals ) {\n\t\t\texternal.sendMessage( type, msg );\n\t\t}\n\t},\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8421b91a50358f2c3d9041ed3310277c814e0a3e","contentHash":"f999ad48714c813384955bd397fa2e44d4c06f2028f1b087b02312e98b9629ee"},"/Users/jim/git/oss/externa/src/logger.js":{"path":"/Users/jim/git/oss/externa/src/logger.js","statementMap":{"0":{"start":{"line":3,"column":0},"end":{"line":5,"column":3}},"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":42}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":24}},"3":{"start":{"line":9,"column":13},"end":{"line":9,"column":53}},"4":{"start":{"line":11,"column":39},"end":{"line":11,"column":95}},"5":{"start":{"line":13,"column":14},"end":{"line":13,"column":35}},"6":{"start":{"line":15,"column":0},"end":{"line":15,"column":25}},"7":{"start":{"line":18,"column":2},"end":{"line":18,"column":82}}},"fnMap":{"0":{"name":"_interopRequireDefault","decl":{"start":{"line":11,"column":9},"end":{"line":11,"column":31}},"loc":{"start":{"line":11,"column":37},"end":{"line":11,"column":97}},"line":11},"1":{"name":"_logger","decl":{"start":{"line":13,"column":23},"end":{"line":13,"column":30}},"loc":{"start":{"line":13,"column":33},"end":{"line":13,"column":35}},"line":13},"2":{"name":"setLogNamespace","decl":{"start":{"line":17,"column":9},"end":{"line":17,"column":24}},"loc":{"start":{"line":17,"column":36},"end":{"line":19,"column":1}},"line":17}},"branchMap":{"0":{"loc":{"start":{"line":11,"column":46},"end":{"line":11,"column":94}},"type":"cond-expr","locations":[{"start":{"line":11,"column":70},"end":{"line":11,"column":73}},{"start":{"line":11,"column":76},"end":{"line":11,"column":94}}],"line":11},"1":{"loc":{"start":{"line":11,"column":46},"end":{"line":11,"column":67}},"type":"binary-expr","locations":[{"start":{"line":11,"column":46},"end":{"line":11,"column":49}},{"start":{"line":11,"column":53},"end":{"line":11,"column":67}}],"line":11}},"s":{"0":3,"1":3,"2":3,"3":3,"4":3,"5":3,"6":3,"7":2},"f":{"0":3,"1":1,"2":2},"b":{"0":[0,3],"1":[3,3]},"inputSourceMap":{"version":3,"sources":["logger.js"],"names":["_logger","setLogNamespace","namespace"],"mappings":";;;;;;;;AAAA;;;;AAEA,IAAIA,OAAO,GAAG,mBAAM,CAAE,CAAtB;;;;AAEO,SAASC,eAAT,CAA0BC,SAA1B,EAAsC;AAC5C,mBAAAF,OAAO,GAAG,yCAAmBE,SAAnB,EAAV;AACA","sourceRoot":"/Users/jim/git/oss/externa/src/","sourcesContent":["import debug from \"debug\";\n\nlet _logger = () => {};\n\nexport function setLogNamespace( namespace ) {\n\t_logger = debug( `externa:${ namespace }` );\n}\n\nexport { _logger as logger };\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"666313e91ce5a73b318b49ee19ac8a736a91be9b","contentHash":"32b10a8d59c0050a427ba3c0b139701aa8ef4740e83856b8dd15b2d0132cad06"},"/Users/jim/git/oss/externa/src/state.js":{"path":"/Users/jim/git/oss/externa/src/state.js","statementMap":{"0":{"start":{"line":3,"column":0},"end":{"line":5,"column":3}},"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":28}},"2":{"start":{"line":8,"column":15},"end":{"line":8,"column":35}},"3":{"start":{"line":10,"column":15},"end":{"line":14,"column":1}},"4":{"start":{"line":15,"column":0},"end":{"line":15,"column":30}},"5":{"start":{"line":16,"column":0},"end":{"line":16,"column":33}}},"fnMap":{},"branchMap":{"0":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":72}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":41}},{"start":{"line":12,"column":45},"end":{"line":12,"column":58}},{"start":{"line":12,"column":62},"end":{"line":12,"column":72}}],"line":12}},"s":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2},"f":{},"b":{"0":[2,1,1]},"inputSourceMap":{"version":3,"sources":["state.js"],"names":["instanceId","isWorker","window","postMessage","location","knownExternals","Map"],"mappings":";;;;;;;AAAA;;eAEe;AACdA,EAAAA,UAAU,EAAE,0BADE;AAEdC,EAAAA,QAAQ,EAAI,OAAOC,MAAP,KAAkB,WAApB,IAAqC,CAAC,CAACC,WAAvC,IAAsD,CAAC,CAACC,QAFpD;AAGdC,EAAAA,cAAc,EAAE,IAAIC,GAAJ;AAHF,C","sourceRoot":"/Users/jim/git/oss/externa/src/","sourcesContent":["import { createUUID } from \"./helpers\";\n\nexport default {\n\tinstanceId: createUUID(),\n\tisWorker: ( typeof window === \"undefined\" ) && !!postMessage && !!location,\n\tknownExternals: new Map(),\n};\n\n\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"9781e95eae83156bc51bb64b47349fc00e2f0c1c","contentHash":"e9ca1f012865690aa8127f8ce5e39ed273a01969aea94466bde86a7d74e958d3"},"/Users/jim/git/oss/externa/src/windowAdapterFsm.js":{"path":"/Users/jim/git/oss/externa/src/windowAdapterFsm.js","statementMap":{"0":{"start":{"line":3,"column":0},"end":{"line":5,"column":3}},"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":50}},"2":{"start":{"line":8,"column":15},"end":{"line":8,"column":57}},"3":{"start":{"line":10,"column":14},"end":{"line":10,"column":33}},"4":{"start":{"line":12,"column":39},"end":{"line":12,"column":95}},"5":{"start":{"line":17,"column":2},"end":{"line":89,"column":3}},"6":{"start":{"line":18,"column":4},"end":{"line":88,"column":7}},"7":{"start":{"line":20,"column":8},"end":{"line":22,"column":10}},"8":{"start":{"line":21,"column":10},"end":{"line":21,"column":67}},"9":{"start":{"line":29,"column":12},"end":{"line":29,"column":120}},"10":{"start":{"line":30,"column":12},"end":{"line":30,"column":47}},"11":{"start":{"line":33,"column":12},"end":{"line":33,"column":117}},"12":{"start":{"line":34,"column":12},"end":{"line":34,"column":47}},"13":{"start":{"line":37,"column":12},"end":{"line":37,"column":117}},"14":{"start":{"line":38,"column":12},"end":{"line":38,"column":47}},"15":{"start":{"line":44,"column":23},"end":{"line":44,"column":32}},"16":{"start":{"line":45,"column":25},"end":{"line":45,"column":36}},"17":{"start":{"line":46,"column":12},"end":{"line":46,"column":79}},"18":{"start":{"line":47,"column":12},"end":{"line":47,"column":40}},"19":{"start":{"line":50,"column":23},"end":{"line":50,"column":33}},"20":{"start":{"line":51,"column":25},"end":{"line":51,"column":37}},"21":{"start":{"line":52,"column":12},"end":{"line":52,"column":77}},"22":{"start":{"line":53,"column":12},"end":{"line":53,"column":37}},"23":{"start":{"line":54,"column":12},"end":{"line":54,"column":34}},"24":{"start":{"line":57,"column":23},"end":{"line":57,"column":33}},"25":{"start":{"line":58,"column":25},"end":{"line":58,"column":37}},"26":{"start":{"line":59,"column":12},"end":{"line":59,"column":77}},"27":{"start":{"line":60,"column":12},"end":{"line":60,"column":37}},"28":{"start":{"line":66,"column":12},"end":{"line":66,"column":47}},"29":{"start":{"line":69,"column":12},"end":{"line":69,"column":47}},"30":{"start":{"line":72,"column":12},"end":{"line":72,"column":47}},"31":{"start":{"line":77,"column":8},"end":{"line":77,"column":28}},"32":{"start":{"line":80,"column":8},"end":{"line":80,"column":29}},"33":{"start":{"line":83,"column":8},"end":{"line":83,"column":30}},"34":{"start":{"line":86,"column":8},"end":{"line":86,"column":35}},"35":{"start":{"line":91,"column":2},"end":{"line":91,"column":21}}},"fnMap":{"0":{"name":"_interopRequireDefault","decl":{"start":{"line":12,"column":9},"end":{"line":12,"column":31}},"loc":{"start":{"line":12,"column":37},"end":{"line":12,"column":97}},"line":12},"1":{"name":"getWindowAdapterFsm","decl":{"start":{"line":16,"column":9},"end":{"line":16,"column":28}},"loc":{"start":{"line":16,"column":31},"end":{"line":92,"column":1}},"line":16},"2":{"name":"initialize","decl":{"start":{"line":19,"column":27},"end":{"line":19,"column":37}},"loc":{"start":{"line":19,"column":40},"end":{"line":23,"column":7}},"line":19},"3":{"name":"(anonymous_3)","decl":{"start":{"line":20,"column":22},"end":{"line":20,"column":23}},"loc":{"start":{"line":20,"column":37},"end":{"line":22,"column":9}},"line":20},"4":{"name":"externaMessage","decl":{"start":{"line":28,"column":38},"end":{"line":28,"column":52}},"loc":{"start":{"line":28,"column":55},"end":{"line":31,"column":11}},"line":28},"5":{"name":"externaPing","decl":{"start":{"line":32,"column":35},"end":{"line":32,"column":46}},"loc":{"start":{"line":32,"column":49},"end":{"line":35,"column":11}},"line":32},"6":{"name":"externaPong","decl":{"start":{"line":36,"column":35},"end":{"line":36,"column":46}},"loc":{"start":{"line":36,"column":49},"end":{"line":39,"column":11}},"line":36},"7":{"name":"externaMessage","decl":{"start":{"line":43,"column":38},"end":{"line":43,"column":52}},"loc":{"start":{"line":43,"column":59},"end":{"line":48,"column":11}},"line":43},"8":{"name":"externaPing","decl":{"start":{"line":49,"column":35},"end":{"line":49,"column":46}},"loc":{"start":{"line":49,"column":54},"end":{"line":55,"column":11}},"line":49},"9":{"name":"externaPong","decl":{"start":{"line":56,"column":35},"end":{"line":56,"column":46}},"loc":{"start":{"line":56,"column":54},"end":{"line":61,"column":11}},"line":56},"10":{"name":"externaMessage","decl":{"start":{"line":65,"column":38},"end":{"line":65,"column":52}},"loc":{"start":{"line":65,"column":55},"end":{"line":67,"column":11}},"line":65},"11":{"name":"externaPing","decl":{"start":{"line":68,"column":35},"end":{"line":68,"column":46}},"loc":{"start":{"line":68,"column":49},"end":{"line":70,"column":11}},"line":68},"12":{"name":"externaPong","decl":{"start":{"line":71,"column":35},"end":{"line":71,"column":46}},"loc":{"start":{"line":71,"column":49},"end":{"line":73,"column":11}},"line":71},"13":{"name":"init","decl":{"start":{"line":76,"column":21},"end":{"line":76,"column":25}},"loc":{"start":{"line":76,"column":28},"end":{"line":78,"column":7}},"line":76},"14":{"name":"pause","decl":{"start":{"line":79,"column":22},"end":{"line":79,"column":27}},"loc":{"start":{"line":79,"column":30},"end":{"line":81,"column":7}},"line":79},"15":{"name":"resume","decl":{"start":{"line":82,"column":23},"end":{"line":82,"column":29}},"loc":{"start":{"line":82,"column":32},"end":{"line":84,"column":7}},"line":82},"16":{"name":"handleMessage","decl":{"start":{"line":85,"column":30},"end":{"line":85,"column":43}},"loc":{"start":{"line":85,"column":59},"end":{"line":87,"column":7}},"line":85}},"branchMap":{"0":{"loc":{"start":{"line":12,"column":46},"end":{"line":12,"column":94}},"type":"cond-expr","locations":[{"start":{"line":12,"column":70},"end":{"line":12,"column":73}},{"start":{"line":12,"column":76},"end":{"line":12,"column":94}}],"line":12},"1":{"loc":{"start":{"line":12,"column":46},"end":{"line":12,"column":67}},"type":"binary-expr","locations":[{"start":{"line":12,"column":46},"end":{"line":12,"column":49}},{"start":{"line":12,"column":53},"end":{"line":12,"column":67}}],"line":12},"2":{"loc":{"start":{"line":17,"column":2},"end":{"line":89,"column":3}},"type":"if","locations":[{"start":{"line":17,"column":2},"end":{"line":89,"column":3}},{"start":{"line":17,"column":2},"end":{"line":89,"column":3}}],"line":17}},"s":{"0":25,"1":25,"2":25,"3":25,"4":25,"5":27,"6":25,"7":25,"8":1,"9":2,"10":2,"11":2,"12":2,"13":2,"14":2,"15":2,"16":2,"17":2,"18":2,"19":3,"20":3,"21":3,"22":3,"23":3,"24":2,"25":2,"26":2,"27":2,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":27},"f":{"0":25,"1":27,"2":25,"3":1,"4":2,"5":2,"6":2,"7":2,"8":3,"9":2,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1},"b":{"0":[0,25],"1":[25,25],"2":[25,2]},"inputSourceMap":{"version":3,"sources":["windowAdapterFsm.js"],"names":["fsmInstance","getWindowAdapterFsm","machina","Fsm","initialize","logger","msg","initialState","states","uninitialized","init","deferUntilTransition","ready","pause","data","remote","instanceId","state","receiveMessage","receivePing","sendPong","receivePong","paused","resume","handle","handleMessage","type","options"],"mappings":";;;;;;;AAAA;;AACA;;;;AAEA,IAAIA,WAAJ;;AAEO,SAASC,mBAAT,GAA+B;AACrC,MAAK,CAACD,WAAN,EAAoB;AACnBA,IAAAA,WAAW,GAAG,IAAIE,oBAAQC,GAAZ,CAAiB;AAC9BC,MAAAA,UAD8B,wBACjB;AACZ,aAAKC,MAAL,GAAc,UAAAC,GAAG,EAAI;AACpB,6DAAiCA,GAAjC;AACA,SAFD;AAGA,OAL6B;AAM9BC,MAAAA,YAAY,EAAE,eANgB;AAO9BC,MAAAA,MAAM,EAAE;AACPC,QAAAA,aAAa,EAAE;AACdC,UAAAA,IAAI,EAAE,OADQ;AAEd,2BAFc,4BAEM;AACnB,iBAAKL,MAAL,CAAa,8FAAb;AACA,iBAAKM,oBAAL,CAA2B,OAA3B;AACA,WALa;AAMd,wBANc,yBAMG;AAChB,iBAAKN,MAAL,CAAa,2FAAb;AACA,iBAAKM,oBAAL,CAA2B,OAA3B;AACA,WATa;AAUd,wBAVc,yBAUG;AAChB,iBAAKN,MAAL,CAAa,2FAAb;AACA,iBAAKM,oBAAL,CAA2B,OAA3B;AACA;AAba,SADR;AAgBPC,QAAAA,KAAK,EAAE;AACNC,UAAAA,KAAK,EAAE,QADD;AAEN,2BAFM,gCAEiC;AAAA,gBAAlBC,IAAkB,QAAlBA,IAAkB;AAAA,gBAAZC,MAAY,QAAZA,MAAY;AACtC,iBAAKV,MAAL,CAAa,sBAAb,EAAqCS,IAAI,CAACE,UAA1C,EAAsDD,MAAM,CAACE,KAA7D;AACAF,YAAAA,MAAM,CAACG,cAAP,CAAuBJ,IAAvB;AACA,WALK;AAMN,wBANM,8BAM8B;AAAA,gBAAlBA,IAAkB,SAAlBA,IAAkB;AAAA,gBAAZC,MAAY,SAAZA,MAAY;AACnC,iBAAKV,MAAL,CAAa,oBAAb,EAAmCS,IAAI,CAACE,UAAxC,EAAoDD,MAAM,CAACE,KAA3D;AACAF,YAAAA,MAAM,CAACI,WAAP,CAAoBL,IAApB;AACAC,YAAAA,MAAM,CAACK,QAAP,CAAiBN,IAAjB;AACA,WAVK;AAWN,wBAXM,8BAW8B;AAAA,gBAAlBA,IAAkB,SAAlBA,IAAkB;AAAA,gBAAZC,MAAY,SAAZA,MAAY;AACnC,iBAAKV,MAAL,CAAa,oBAAb,EAAmCS,IAAI,CAACE,UAAxC,EAAoDD,MAAM,CAACE,KAA3D;AACAF,YAAAA,MAAM,CAACM,WAAP,CAAoBP,IAApB;AACA;AAdK,SAhBA;AAgCPQ,QAAAA,MAAM,EAAE;AACPC,UAAAA,MAAM,EAAE,OADD;AAEP,2BAFO,4BAEa;AACnB,iBAAKZ,oBAAL,CAA2B,OAA3B;AACA,WAJM;AAKP,wBALO,yBAKU;AAChB,iBAAKA,oBAAL,CAA2B,OAA3B;AACA,WAPM;AAQP,wBARO,yBAQU;AAChB,iBAAKA,oBAAL,CAA2B,OAA3B;AACA;AAVM;AAhCD,OAPsB;AAqD9BD,MAAAA,IArD8B,kBAqDvB;AACN,aAAKc,MAAL,CAAa,MAAb;AACA,OAvD6B;AAyD9BX,MAAAA,KAzD8B,mBAyDtB;AACP,aAAKW,MAAL,CAAa,OAAb;AACA,OA3D6B;AA6D9BD,MAAAA,MA7D8B,oBA6DrB;AACR,aAAKC,MAAL,CAAa,QAAb;AACA,OA/D6B;AAiE9BC,MAAAA,aAjE8B,yBAiEfC,IAjEe,EAiETC,OAjES,EAiEC;AAC9B,aAAKH,MAAL,CAAaE,IAAb,EAAmBC,OAAnB;AACA;AAnE6B,KAAjB,CAAd;AAqEA;;AACD,SAAO3B,WAAP;AACA","sourceRoot":"/Users/jim/git/oss/externa/src/","sourcesContent":["import machina from \"machina\";\nimport { logger } from \"./logger\";\n\nlet fsmInstance;\n\nexport function getWindowAdapterFsm() {\n\tif ( !fsmInstance ) {\n\t\tfsmInstance = new machina.Fsm( {\n\t\t\tinitialize() {\n\t\t\t\tthis.logger = msg => {\n\t\t\t\t\tlogger( `[window-adapter-fsm] ${ msg }` );\n\t\t\t\t};\n\t\t\t},\n\t\t\tinitialState: \"uninitialized\",\n\t\t\tstates: {\n\t\t\t\tuninitialized: {\n\t\t\t\t\tinit: \"ready\",\n\t\t\t\t\t\"externa.message\"() {\n\t\t\t\t\t\tthis.logger( \"externa has not been initialized, but is receiving messages. Be sure to call externa.init().\" );\n\t\t\t\t\t\tthis.deferUntilTransition( \"ready\" );\n\t\t\t\t\t},\n\t\t\t\t\t\"externa.ping\"() {\n\t\t\t\t\t\tthis.logger( \"externa has not been initialized, but is receiving pings. Be sure to call externa.init().\" );\n\t\t\t\t\t\tthis.deferUntilTransition( \"ready\" );\n\t\t\t\t\t},\n\t\t\t\t\t\"externa.pong\"() {\n\t\t\t\t\t\tthis.logger( \"externa has not been initialized, but is receiving pongs. Be sure to call externa.init().\" );\n\t\t\t\t\t\tthis.deferUntilTransition( \"ready\" );\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tready: {\n\t\t\t\t\tpause: \"paused\",\n\t\t\t\t\t\"externa.message\"( { data, remote, } ) {\n\t\t\t\t\t\tthis.logger( \"NORMAL MESSAGE FROM:\", data.instanceId, remote.state );\n\t\t\t\t\t\tremote.receiveMessage( data );\n\t\t\t\t\t},\n\t\t\t\t\t\"externa.ping\"( { data, remote, } ) {\n\t\t\t\t\t\tthis.logger( \"PING MESSAGE FROM:\", data.instanceId, remote.state );\n\t\t\t\t\t\tremote.receivePing( data );\n\t\t\t\t\t\tremote.sendPong( data );\n\t\t\t\t\t},\n\t\t\t\t\t\"externa.pong\"( { data, remote, } ) {\n\t\t\t\t\t\tthis.logger( \"PONG MESSAGE FROM:\", data.instanceId, remote.state );\n\t\t\t\t\t\tremote.receivePong( data );\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tpaused: {\n\t\t\t\t\tresume: \"ready\",\n\t\t\t\t\t\"externa.message\"() {\n\t\t\t\t\t\tthis.deferUntilTransition( \"ready\" );\n\t\t\t\t\t},\n\t\t\t\t\t\"externa.ping\"() {\n\t\t\t\t\t\tthis.deferUntilTransition( \"ready\" );\n\t\t\t\t\t},\n\t\t\t\t\t\"externa.pong\"() {\n\t\t\t\t\t\tthis.deferUntilTransition( \"ready\" );\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\n\t\t\tinit() {\n\t\t\t\tthis.handle( \"init\" );\n\t\t\t},\n\n\t\t\tpause() {\n\t\t\t\tthis.handle( \"pause\" );\n\t\t\t},\n\n\t\t\tresume() {\n\t\t\t\tthis.handle( \"resume\" );\n\t\t\t},\n\n\t\t\thandleMessage( type, options ) {\n\t\t\t\tthis.handle( type, options );\n\t\t\t},\n\t\t} );\n\t}\n\treturn fsmInstance;\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"20fc7c89dc57487e2a35a8e5b20ccbd952552452","contentHash":"46f2e28b1e825ed140e4aab542ba144758d31d6bad5e65dd22be71c58cb7f76c"}}